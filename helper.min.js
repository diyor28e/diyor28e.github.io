(function(){var a=false;window.ZmOptimizelyHelper={initPersist:function(){try{var c=window.campaignSaveConfig||{};if(a||!window.zmGlobalMrktKey||!Object.keys(c).length){return}var f=window.optimizely||[];var b=window.campaignVariants||{};window.campaignBlock=window.campaignBlock||[];Object.keys(b).forEach(function(e){var h=b[e];var i=c[h.eId];if(!i||i.type!==h.type){return}if(i.type==="account"&&h.zId&&h.zId!==window.zmGlobalMrktKey){window.campaignBlock.push(h.eId)}else{f.push({type:"bucketVisitor",experimentId:h.eId,variationId:h.vId})}});f.push({type:"addListener",filter:{type:"lifecycle",name:"campaignDecided"},handler:d});function d(k){var j=k.data&&k.data.decision;var l=c[j.experimentId];if(!l){return}var h=b[j.experimentId];var i=h&&h.vId;if(i!==j.variationId){var m=new XMLHttpRequest();m.open("POST","/optimizely/save");m.setRequestHeader("Content-type","application/json;charset=UTF-8");var e={type:l.type,eId:j.experimentId,vId:j.variationId};if(l.unique){e.unique=true}m.send(JSON.stringify(e))}}a=true}catch(g){console.error("Optly save/restore error",g)}}}})();